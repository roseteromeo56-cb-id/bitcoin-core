(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[184],{78444:function(e,t,s){"use strict";s.d(t,{o:function(){return a}});var r=s(23549);let a=async e=>{let{queryId:t,parameters:s,requestContext:a,activeContext:l,executionType:n,performance:i,executionService:o}=e;return await (0,r.b)({func:()=>o.executeQuery({query:{id:t,parameters:null!=s?s:[]},requestContext:a,executionContext:l,executionType:n,performance:i}),activeContext:l,queryId:t})}},184:function(e,t,s){"use strict";s.d(t,{j:function(){return eM}});var r=s(85893),a=s(67294),l=s(40802),n=s(69850),i=s.n(n),o=s(73874),u=s(67165),d=s(17479),c=s(66465),v=s(335),m=s(85949),g=s(60734),h=s(57831),x=s(36278),p=s(12637),f=s(61800),_=s(9825),j=s(80879),y=s(51414),S=s(94184),b=s.n(S);let w=(0,a.forwardRef)((e,t)=>{let{theme:s="orange"}=e,a=b()(i().wrap,i()["theme-".concat(s)],!0===e.transparent&&i().transparent,(0,o.Ms)(e.visual)&&i().text,(0,o.fl)(e.visual)&&i().counter,(0,o.XR)(e.visual)&&i().chart,(0,o.dL)(e.visual)&&i().table,e.className);return(0,r.jsx)("div",{className:a,ref:t,children:e.children})});var q=s(13886);let C=e=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(q.a,{...e}),(0,r.jsx)("div",{className:b()(i().result,!0===e.stretch&&i()["stretch-results"]),children:e.children})]});var E=s(31992),N=s(60403),R=s(78444);let I=e=>{let{executionService:t}=e;return(0,r.jsxs)(w,{theme:e.theme,visual:e.visual,transparent:e.transparent,className:b()(i().message,e.className),children:[(0,r.jsx)(C,{...e,children:(0,r.jsx)("div",{className:i().resultMessage,children:e.children})}),(0,r.jsx)("div",{className:i().vizFooter,children:(0,r.jsxs)("div",{className:i().ownerStatuses,children:[(0,r.jsx)(E.u,{...e}),(0,r.jsxs)("div",{className:b()(i().statuses,N.R),children:[(0,r.jsx)(_.x,{dashboard:e.dashboard,queryDetails:e.visual.query_details,isResultReady:e.resultSet.canBeRefreshed(),onRefreshQuery:e=>{var s;let r={...e,requestContext:{session:e.session},executionService:t,executionType:"interactive",parameters:null!==(s=e.parameters)&&void 0!==s?s:[]};(0,R.o)(r)}}),(0,r.jsx)(j.j,{queryDetails:e.visual.query_details}),void 0!==e.resultSet&&(0,r.jsx)(y.J,{resultSet:e.resultSet,loadingError:e.loadingResultError,iframe:!!e.iframe})]})]})})]})};var z=s(68357),B=s(89126),P=s(61575),k=s(46367),F=s(96008),M=s(46068);let T=e=>{let{executionService:t}=e,{resultWithPayload:s}=e,{counterColName:l}=e.visual.options,n=s.data.rows[0],o=(0,P.$K)(l)&&(0,P.$K)(n)?n[l]:void 0,u=(0,k.n)(o)?(0,F.iM)(o):null,d=(0,B.FW)(e.visual,u),c=(0,B.cX)(e.visual),[v,m]=a.useState(null),g=Math.max(40*d.length,15*c.length,350);return(0,r.jsxs)(w,{...e,ref:m,children:[(0,r.jsxs)(C,{...e,children:[e.watermark&&(0,r.jsx)("img",{src:"/assets/glyph.svg",className:i().watermark,"aria-hidden":!0,alt:""}),(0,r.jsxs)("svg",{viewBox:"0 0 ".concat(g," ").concat(g/5),children:[d&&(0,r.jsx)("text",{x:"50%",y:"50%",textAnchor:"middle",dominantBaseline:c?"bottom":"middle",fontSize:"3em",fill:(()=>{if((0,P.hj)(u)){if(e.visual.options.coloredPositiveValues&&u>0)return"var(--feedback--accent--success)";if(e.visual.options.coloredNegativeValues&&u<0)return"var(--feedback--accent--error)"}})(),children:d}),c&&(0,r.jsx)("text",{x:"50%",y:"85%",textAnchor:"middle",dominantBaseline:d?"top":"middle",fontSize:"1.5em",children:c})]})]}),(0,r.jsx)("div",{className:i().vizFooter,children:(0,r.jsxs)("div",{className:i().ownerStatuses,children:[(0,r.jsx)(E.u,{...e}),(0,r.jsxs)("div",{className:b()(i().statuses,N.R),children:[!e.iframe&&v&&(0,P.$K)(e.queryId)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(M.q,{queryId:e.queryId}),(0,r.jsx)(N.G,{visualElement:v,queryId:e.queryId,visualizationId:e.visual.id})]}),(0,r.jsx)(_.x,{dashboard:e.dashboard,queryDetails:e.visual.query_details,isResultReady:e.resultSet.canBeRefreshed(),onRefreshQuery:e=>{var s;let r={...e,requestContext:{session:e.session},executionService:t,executionType:"interactive",parameters:null!==(s=e.parameters)&&void 0!==s?s:[]};(0,R.o)(r)}}),(0,r.jsx)(j.j,{queryDetails:e.visual.query_details}),(0,k.n)(e.resultSet)&&(0,r.jsx)(y.J,{resultSet:e.resultSet,loadingError:e.loadingError,iframe:!!e.iframe})]})]})})]})};var L=s(30653);let A=e=>(0,r.jsx)(w,{...e,children:void 0!==e.visual.html&&(0,r.jsx)("div",{className:i().html,children:(0,L.ZP)(e.visual.html,{transform:e=>{(null==e?void 0:e.type)!=="tag"||(null==e?void 0:e.name)!=="a"||e.attribs.href.startsWith("#")||(e.attribs.target="_blank")}})})});var D=s(46509),V=s(31510);let J=e=>{let{getExecutionProps:t}=e;return e=>{let s=(0,V.z)(t),r=e.executionRequests.get(s);return null!=r?r:{requestStatus:"init"}}};function K(e){let{skip:t,executionService:s}=e,r=null!=t&&t,[l,n]=(0,a.useState)({requestStatus:"init"}),i=(0,D.v)(()=>e.getExecutionProps,[(0,V.I)(e.getExecutionProps)]);return((0,a.useEffect)(()=>{if(!r&&""!==i.executionId){let e=s.cache.subscribe(J({getExecutionProps:i}),n,{fireImmediately:!0}),t=s.pollForCompletedExecution(i);return t.pollToCompletion(),()=>{t.stopPolling(),e()}}},[i,s,r]),r)?{requestStatus:"init"}:l}var W=s(91571);let $=e=>{let{executionService:t}=e,s=e.resultWithPayload.data,[l,n]=(0,a.useState)(null),o=!!e.iframe;return(0,r.jsxs)(w,{...e,ref:n,children:[(0,r.jsx)(C,{stretch:!0,...e,children:s.rows.length>0&&(0,r.jsx)(W.k,{visual:e.visual,result:s,watermark:e.watermark})}),(0,r.jsx)("div",{className:i().vizFooter,children:(0,r.jsxs)("div",{className:i().ownerStatuses,children:[(0,r.jsx)(E.u,{...e}),(0,r.jsxs)("div",{className:b()(i().statuses,N.R),children:[!o&&l&&(0,P.$K)(e.queryId)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(M.q,{queryId:e.queryId}),(0,r.jsx)(N.G,{visualElement:l,queryId:e.queryId,visualizationId:e.visual.id})]}),(0,r.jsx)(_.x,{dashboard:e.dashboard,queryDetails:e.visual.query_details,isResultReady:e.resultSet.canBeRefreshed(),onRefreshQuery:e=>{var s;let r={...e,requestContext:{session:e.session},executionService:t,executionType:"interactive",parameters:null!==(s=e.parameters)&&void 0!==s?s:[]};(0,R.o)(r)}}),(0,r.jsx)(j.j,{queryDetails:e.visual.query_details}),(0,k.n)(e.resultSet)&&(0,r.jsx)(y.J,{resultSet:e.resultSet,loadingError:e.loadingError,iframe:!!e.iframe})]})]})})]})};s(35666);var G=s(28082),O=s.n(G),Q=s(27060),Z=s(74094),H=s(52376),X=s.n(H),U=s(78528),Y=s(88812),ee=s(10933),et=s(39138),es=s.n(et),er=s(80949),ea=s(47701),el=s(36968),en=s.n(el),ei=s(94682),eo=s(39612),eu=s(51577);let ed=e=>{let{cell:t}=e,s=t.getValue();return"string"==typeof s&&s.includes("\n")?(0,r.jsx)(ec,{cell:t}):(0,r.jsx)("td",{children:(0,Z.ie)(t.column.columnDef.cell,t.getContext())},t.id)},ec=e=>{let{cell:t}=e,[s,l]=(0,a.useState)(!1);return(0,r.jsx)("td",{id:t.id,children:(0,r.jsxs)("div",{className:b()(X().withButton,s&&X().expandLines),children:[(0,r.jsx)(ee.h,{size:"XS",theme:"ghost","aria-label":s?"collapse":"expand",onClick:()=>l(e=>!e),children:s?(0,r.jsx)(U.IconChevronDown,{}):(0,r.jsx)(Y.IconChevronBarExpand,{})}),(0,Z.ie)(t.column.columnDef.cell,t.getContext())]})})},ev=e=>{let{visual:t,column:s,options:a,cellData:l}=e;return e=>{let{getCellValueInPercentage:n}=l||{},o=(0,F.iM)(e.row.getValue(s.name));return(null==a?void 0:a.type)==="progressbar"&&n&&(0,P.hj)(o)?(0,r.jsx)(e_,{percentage:n(o),className:b()(em(t,s),ej(a,o),o<0&&i().negative),children:eg(e.row.getValue(s.name),t,s)}):(0,r.jsx)("div",{className:b()(em(t,s),(0,P.hj)(o)&&ej(a,o)),children:eg(e.row.getValue(s.name),t,s)})}},em=(e,t)=>{let s=ep(e,t),r="timestamp"===t.type||"timestamp with time zone"===t.type;return b()(r&&i().datetime,(null==s?void 0:s.alignContent)==="left"&&i().left,(null==s?void 0:s.alignContent)==="right"&&i().right,(null==s?void 0:s.alignContent)==="center"&&i().center)},eg=(e,t,s)=>{let a=(0,F.iM)(e);if(""===a||null===a||null===e)return(0,r.jsx)("span",{className:i().empty,"aria-hidden":!0});if(Array.isArray(e))return(0,r.jsx)(eh,{value:a});if("number"==typeof a){var l;return(0,ei.uf)(a,null===(l=ep(t,s))||void 0===l?void 0:l.numberFormat)}if("string"==typeof a&&(0,eo.mD)(a))return(0,eo.EZ)(a);if("string"==typeof a)try{return(0,r.jsx)(ex,{value:a})}catch(e){eu.k.warn("failed to parse table html:",a)}return a},eh=e=>{let t="".concat(e.value),s=es()(t,{length:50,omission:""}),l=t.length!==s.length,[n,o]=a.useState(!1),u=()=>o(e=>!e);return(0,r.jsxs)("div",{className:i().tableListValue,children:[n?t:s,!n&&l&&(0,r.jsx)("button",{onClick:u,"aria-label":"Expand",className:i().expandButton,children:(0,r.jsx)("small",{children:"•••"})}),n&&l&&(0,r.jsx)("button",{onClick:u,"aria-label":"Contract",className:i().contractButton,children:(0,r.jsx)(er.J,{icon:"arrow-left"})})]})},ex=e=>(0,r.jsx)("div",{dangerouslySetInnerHTML:{__html:(0,ea.j)(e.value)}}),ep=(e,t)=>{var s,r;return null===(r=e.options)||void 0===r?void 0:null===(s=r.columns)||void 0===s?void 0:s.find(e=>e.name===t.name)},ef=(e,t)=>{let s={};if((0,k.n)(t)){var r;null===(r=e.columns)||void 0===r||r.forEach(e=>{if("progressbar"===e.type){let r=t.rows[0],a=r["max_".concat(e.name)],l=r["min_".concat(e.name)];en()(s,[e.name],{getCellValueInPercentage:e=>{if("number"!=typeof l||"number"!=typeof a)return null;let t=Math.abs(e<0?l:a),s=Math.abs(e);return s>0&&t>0?s/t*100:0}})}})}return s},e_=e=>{let{percentage:t,children:s,className:a}=e;return(0,r.jsxs)("div",{className:b()(i().progressbar,a),style:{"--progress":"".concat(t,"%")},children:[(0,r.jsx)("div",{}),s]})},ej=(e,t)=>b()((null==e?void 0:e.coloredPositiveValues)===!0&&t>0&&i().coloredPositive,(null==e?void 0:e.coloredNegativeValues)===!0&&t<0&&i().coloredNegative),ey=e=>{var t;let{execution:s,visual:l}=e,{options:n}=l,i=s.data.rows,o=(0,Q.Cl)(),u=(0,a.useMemo)(()=>s.columnsMetadata.filter(e=>{var t,s;return(null===(s=n.columns)||void 0===s?void 0:null===(t=s.find(t=>t.name===e.name))||void 0===t?void 0:t.isHidden)!==!0}).map(t=>{var s,a,i;let u=ef(n,null===(s=e.columnAggregatesExec)||void 0===s?void 0:s.data);return o.accessor(e=>e[t.name],{id:t.name||"5847052339_dune_unnamed",header:e=>{var s;let{header:n}=e;return(0,r.jsx)("button",{type:"button",className:b()(null!==(a=n.column.columnDef.meta)&&void 0!==a?a:em(l,t)),onClick:()=>{let e=n.column.getIsSorted();if(n.column.clearSorting(),e)switch(e){case"asc":break;case"desc":n.column.toggleSorting(!1)}else n.column.toggleSorting(!0)},children:null!==(i=null===(s=ep(l,t))||void 0===s?void 0:s.title)&&void 0!==i?i:t.name})},cell:ev({visual:l,column:t,options:ep(l,t),cellData:u[t.name]})})}),[s.data.columns,null===(t=e.columnAggregatesExec)||void 0===t?void 0:t.data]),d=(0,Z.b7)({columns:u,data:i,manualSorting:!0,state:{sorting:e.sortBy},onSortingChange:e.onSortChange,getCoreRowModel:(0,Q.sC)()});return(0,r.jsxs)("table",{className:O().table,children:[(0,r.jsx)("thead",{children:d.getHeaderGroups().map(e=>(0,r.jsx)("tr",{children:e.headers.map(e=>(0,r.jsx)("th",{"aria-sort":eS(e.column),children:(0,Z.ie)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,r.jsx)("tbody",{children:d.getRowModel().rows.map(e=>(0,r.jsx)("tr",{children:e.getVisibleCells().map(e=>(0,r.jsx)(ed,{cell:e},e.id))},e.id))})]})},eS=e=>{let t=e.getIsSorted();if(!t)return"none";switch(t){case"asc":return"ascending";case"desc":return"descending"}};var eb=s(79521),ew=s(47730),eq=s(89579);let eC=e=>{var t,s,a;let{globalFilter:l,setGlobalFilter:n}=e,i=e.pageCount>1,o=(null!==(t=e.total)&&void 0!==t?t:0)<100*e.pageSize,u=!!e.search,{ref:d}=eN(i),c=(0,eq.M)({sizeInBytes:null!==(s=e.requestResultSizeBytes)&&void 0!==s?s:1073741824});return(0,r.jsxs)("ul",{ref:d,className:b()(O().footer,null!==(a=e.className)&&void 0!==a?a:O()["footer-defaults"]),children:["number"==typeof e.total&&(0,r.jsx)("li",{"data-min-parent-width":380,children:(0,r.jsxs)("span",{className:O().total,children:[e.total.toLocaleString()," ",1===e.total?"row":"rows",e.maxResultSizeReached&&(0,r.jsx)(ew.u,{style:{maxWidth:250,whiteSpace:"normal"},position:"above-center",label:(0,r.jsxs)(r.Fragment,{children:["This query result reached our ",c,"GB maximum limit and contains additional rows that can not be displayed"]}),children:(0,r.jsx)("div",{className:O().warning,children:(0,r.jsx)(er.J,{icon:"warning-triangle"})})})]})}),u&&(0,r.jsx)("li",{children:(0,r.jsx)(eE,{globalFilter:l,setGlobalFilter:n})}),i&&(0,r.jsx)("li",{children:(0,r.jsx)("button",{type:"button",onClick:()=>e.gotoPage(0),disabled:0===e.pageIndex,children:(0,r.jsx)(er.J,{icon:"chevron-double-left","aria-label":"First page"})})}),i&&(0,r.jsx)("li",{children:(0,r.jsx)("button",{type:"button",onClick:()=>e.gotoPage(e.pageIndex-1),disabled:0===e.pageIndex,children:(0,r.jsx)(er.J,{icon:"chevron-left","aria-label":"Previous page"})})}),i&&o&&(0,r.jsx)("li",{"data-min-parent-width":520,children:(0,r.jsx)("select",{value:e.pageIndex,onChange:t=>{e.gotoPage(parseInt(t.target.value,10))},"aria-label":"Select page",children:e.pageOptions.map(e=>(0,r.jsxs)("option",{value:e,children:["Page ",e+1]},e))})}),i&&(0,r.jsx)("li",{children:(0,r.jsx)("button",{type:"button",onClick:()=>{e.gotoPage(e.pageIndex+1)},disabled:e.pageIndex===e.pageCount-1,children:(0,r.jsx)(er.J,{icon:"chevron-right","aria-label":"Next page"})})}),i&&(0,r.jsx)("li",{children:(0,r.jsx)("button",{type:"button",onClick:()=>e.gotoPage(e.pageCount-1),disabled:e.pageIndex===e.pageCount-1,children:(0,r.jsx)(er.J,{icon:"chevron-double-right","aria-label":"Last page"})})})]})},eE=e=>{var t;let[s,l]=a.useState(null!==(t=e.globalFilter)&&void 0!==t?t:""),n=(0,eb.useAsyncDebounce)(t=>{var s;null===(s=e.setGlobalFilter)||void 0===s||s.call(e,t)},200);return(0,r.jsx)("input",{"aria-label":"Search",placeholder:"Search...",value:s||"",onChange:e=>{n(e.target.value),l(e.target.value)},onKeyDown:e=>{("Esc"===e.key||"Escape"===e.key)&&(n(""),l(""))}})},eN=e=>{let t=a.useRef(null),s=()=>{if(t.current){var e;let s=t.current.getBoundingClientRect().width,r=null===(e=t.current)||void 0===e?void 0:e.querySelectorAll("*[data-min-parent-width]");r.forEach(e=>{Number(e.dataset.minParentWidth)>s?e.classList.add(O().hidden):e.classList.remove(O().hidden)})}};return a.useEffect(()=>{if(e)return window.addEventListener("resize",s),s(),()=>{window.removeEventListener("resize",s)}},[e]),{ref:t}};var eR=s(14522);let eI=e=>{let{executionService:t,getExecutionProps:s}=e,[r,l]=(0,a.useState)(),n=K({getExecutionProps:{...s,resultConfig:new f.$({...s.resultConfig.config,whereClause:r})},executionService:t}),i=(0,a.useCallback)(e=>{if((0,eR.D)(n)){let t=n.responsePayload.columnsMetadata.map(e=>e.name).map(t=>'"'.concat(t,"\" ILIKE '%").concat(e.replace("'","\\'"),"%'")).join(" OR ");l(t)}},[n]);return(0,a.useMemo)(()=>({search:i,result:n}),[n,i])},ez=e=>{var t,s,l,n,o,u,d;let{executionService:c,executionMeta:v,columnAggregates:m}=e,g=e.resultSet.resultToShow(),x=(0,h.kP)(),[p,S]=(0,a.useState)(null),[q,I]=(0,a.useState)(),[z,B]=(0,a.useState)(0),[k,F]=(0,a.useState)([]),T=v.totalRowCount,L=0===e.pageSize?0:Math.ceil(T/e.pageSize),A=[...Array(L).keys()],D=v.maxResultSizeReachedBytes,V=v.requestMaxResultSizeBytes,J=m.configs.length>0,{result:W,search:$}=eI({getExecutionProps:{executionId:null!==(t=null==g?void 0:g.executionId)&&void 0!==t?t:"",queryId:null!==(s=null==g?void 0:g.queryId)&&void 0!==s?s:-1,requestContext:{session:x},parameters:null!==(l=null==g?void 0:g.parameters)&&void 0!==l?l:[],resultConfig:new f.$({limit:e.pageSize,offset:z*e.pageSize,sortBy:k.map(e=>({column:e.id,direction:e.desc?"desc":"asc"}))})},executionService:c}),G=K({getExecutionProps:{executionId:null!==(n=null==g?void 0:g.executionId)&&void 0!==n?n:"",queryId:null!==(o=null==g?void 0:g.queryId)&&void 0!==o?o:-1,requestContext:{session:x},parameters:null!==(u=null==g?void 0:g.parameters)&&void 0!==u?u:[],resultConfig:m},skip:!J,executionService:c}),O=J&&"success"===G.requestStatus&&"success"===G.responsePayload.status?G.responsePayload:void 0,Q=!!e.iframe;return(0,r.jsxs)(w,{...e,ref:S,children:[(0,r.jsx)(C,{...e,children:(()=>{if((null==W?void 0:W.requestStatus)==="error"){let t=W.error instanceof Error?W.error:Error(String(W.error));return(0,r.jsx)(C,{...e,children:null==t?void 0:t.message})}if((null==W?void 0:W.requestStatus)==="init"||(null==W?void 0:W.requestStatus)==="loading"&&(null==W?void 0:W.responsePayload)===void 0)return(0,r.jsx)("div",{className:i().resultMessage,children:"Loading..."});if((null==W?void 0:W.requestStatus)==="success"||(null==W?void 0:W.requestStatus)==="loading"&&(null==W?void 0:W.responsePayload)!==void 0){var t;return(null===(t=W.responsePayload)||void 0===t?void 0:t.status)!=="success"?null:(0,r.jsx)(ey,{execution:W.responsePayload,visual:e.visual,onSortChange:e=>{F(e),B(0)},sortBy:k,columnAggregatesExec:O})}return null})()}),(0,r.jsxs)("div",{className:i().vizFooter,children:[(0,r.jsx)(eC,{globalFilter:q,setGlobalFilter:e=>{I(e),$(e),B(0)},pageIndex:z,pageOptions:A,pageCount:L,gotoPage:B,pageSize:e.pageSize,search:null===(d=e.search)||void 0===d||d,total:T,maxResultSizeReached:!!D,requestResultSizeBytes:V}),(0,r.jsxs)("div",{className:i().ownerStatuses,children:[(0,r.jsx)(E.u,{...e}),(0,r.jsxs)("div",{className:b()(i().statuses,N.R),children:[!Q&&p&&(0,P.$K)(e.queryId)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(M.q,{queryId:e.queryId}),(0,r.jsx)(N.G,{visualElement:p,queryId:e.queryId,visualizationId:e.visual.id})]}),(0,r.jsx)(_.x,{dashboard:e.dashboard,queryDetails:e.visual.query_details,isResultReady:e.resultSet.canBeRefreshed(),onRefreshQuery:e=>{var t;let s={...e,requestContext:{session:e.session},executionService:c,executionType:"interactive",parameters:null!==(t=e.parameters)&&void 0!==t?t:[]};(0,R.o)(s)}}),(0,r.jsx)(j.j,{queryDetails:e.visual.query_details}),(0,r.jsx)(y.J,{resultSet:e.resultSet,iframe:Q,loadingError:void 0})]})]})]})]})};var eB=s(74075),eP=s(45578),ek=s.n(eP),eF=s(6213);let eM=e=>{var t,s,n,_,j,y,S;let{visual:b,resultSet:w,queryFixable:q=!1,onRenderResult:C}=e,E=(0,h.kP)(),N=w.statusType(),{captureEvent:R}=(0,c.z$)();(0,x.M)(b,N,e.queryId,null===(t=e.dashboard)||void 0===t?void 0:t.id);let z=w.resultToShow(),B=function(e,t){var s,r,a,n,i,o;if(!(0,k.n)(t)||"success"!==t.status)return new f.$({limit:1});let u=new Set(t.columnsMetadata.map(e=>e.name));switch(e.type){case"counter":{let l=t.totalRowCount,n=null!==(a=null===(s=e.options)||void 0===s?void 0:s.rowNumber)&&void 0!==a?a:1;return new f.$({limit:1,offset:n>l?l-1:0===n?0:n>0?(l+n-1)%l:(l+n)%l,outputColums:(null===(r=e.options)||void 0===r?void 0:r.counterColName)!==void 0&&u.has(e.options.counterColName)?[e.options.counterColName]:void 0})}case"chart":{let s=e.options.columnMapping;if(void 0===s){let t=Error("Chart visual must specify columns to use");throw l.Tb(t,{extra:{vizId:e.id}}),t}let r=Object.keys(s).filter(e=>u.has(e));if((null===(i=(n=e.options).series)||void 0===i?void 0:i.stacking)==="stack"&&Object.values(null!==(o=n.columnMapping)&&void 0!==o?o:[]).includes("series")){if(t.totalRowCount>=32e3)return new f.$({});return new f.$({outputColums:r})}return new f.$({outputColums:r,sampleSize:8e3})}case"table":return new f.$({limit:25,offset:0});default:return new f.$({limit:1})}}(b,z),F=function(e){if("table"===e.type){var t;let s=ek()(null===(t=e.options.columns)||void 0===t?void 0:t.filter(e=>"progressbar"===e.type),e=>e.name).map(e=>[{columnName:e.name,aggregateColumnName:"max_"+e.name,aggregateFn:"max"},{columnName:e.name,aggregateColumnName:"min_"+e.name,aggregateFn:"min"}]).flat();return new eB.d(s)}return new eB.d([])}(b),M=K({getExecutionProps:{executionId:null!==(n=null==z?void 0:z.executionId)&&void 0!==n?n:"",queryId:null!==(_=null==z?void 0:z.queryId)&&void 0!==_?_:-1,requestContext:{session:E},parameters:null!==(j=null==z?void 0:z.parameters)&&void 0!==j?j:[],resultConfig:B},skip:w.resultToShowPending(),executionService:p.T}),L=void 0===w.resultToShow()&&w.isFetching||(null==z?void 0:z.status)==="success"&&("loading"===M.requestStatus||"init"===M.requestStatus),D=()=>"error"===M.requestStatus?M.error instanceof Error?M.error:Error(String(M.error)):"success"!==M.requestStatus&&void 0!==w.fetchError?w.fetchError:void 0,V="success"===M.requestStatus?M.responsePayload:void 0,J=("complete"===N||"queuedWithStaleResult"===N||"runningWithStaleResult"===N||"errorWithStaleResult"===N)&&(null==V?void 0:V.status)==="success";if((0,a.useEffect)(()=>{"unknown"!==N&&R("VisualItem viewed",{statusType:N})},[N]),(0,a.useEffect)(()=>{J&&C&&C()},[J]),(0,o.Ms)(b))return(0,r.jsx)(A,{...e,visual:b});if((0,o.QS)(b))return(0,r.jsx)(d.d,{parameter:e.param,parameters:e.parameters});if(L)return(0,r.jsx)(I,{...e,loadingResultError:D(),visual:b,executionService:p.T,children:"Loading"});if((null==z?void 0:z.status)==="queued")return(0,r.jsxs)(I,{...e,loadingResultError:D(),visual:b,executionService:p.T,children:[(0,r.jsx)("p",{children:"Queued (".concat(null==z?void 0:z.queuePosition,")")}),(0,r.jsx)(m.H,{})]});if((null==z?void 0:z.status)==="running"){let t=z.progressPercentage;return(0,r.jsxs)(I,{...e,loadingResultError:D(),visual:b,executionService:p.T,children:[(0,r.jsx)("div",{className:i().runningStatus,children:void 0!==t?(0,r.jsx)(eF.E,{label:0===t?(0,r.jsx)("p",{children:"Planning"}):(0,r.jsxs)("p",{children:["Running ",Math.round(t),"%"]}),value:t,theme:"orange",max:100,showLabel:!0,className:i().progressBarWrapper}):(0,r.jsx)("p",{children:"Running"})}),void 0!==z.createdAt&&(0,r.jsx)(g.C,{executionStartedAt:new Date(z.createdAt)})]})}if("unknown"===N||(y=null===(s=D())||void 0===s?void 0:s.message,["Please re-run the query to get a new result","column names are not unique"].some(e=>null==y?void 0:y.includes(e))))return(0,r.jsx)(I,{...e,loadingResultError:D(),visual:b,executionService:p.T,children:'Click "Run" to get results'});if((null==z?void 0:z.status)==="failed"||void 0!==D()){let t=(null==z?void 0:z.status)==="failed"?z:void 0,s=(S=D(),(0,k.n)(t)?t.message:(0,k.n)(S)?S.message.toLowerCase().includes("deprecated query engine")?S.message:"Fetching results failed":void 0);return(0,r.jsxs)(I,{...e,loadingResultError:D(),visual:b,executionService:p.T,children:[eT((0,u.zO)(s)),E&&q&&(0,P.$K)(t)&&(0,r.jsx)(v.N,{errorMessage:t.message})]})}if(w.isEmptyResults())return(0,r.jsx)(I,{...e,loadingResultError:D(),visual:b,executionService:p.T,children:"No results from query."});if(J){if((0,o.XR)(b))return(0,r.jsx)($,{...e,visual:b,executionService:p.T,resultWithPayload:V,loadingError:D()});if((0,o.fl)(b))return(0,r.jsx)(T,{...e,resultWithPayload:V,loadingError:D(),visual:b,executionService:p.T});if((0,o.dL)(b))return(0,r.jsx)(ez,{...e,pageSize:25,executionService:p.T,loadingError:D(),executionMeta:V,visual:b,columnAggregates:F})}return null},eT=e=>{let t=/\b(https?:\/\/(?:www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b(?:[-a-zA-Z0-9()@:%_+~#&/=]|([?.]\S))*)|(www\.[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b(?:[-a-zA-Z0-9()@:%_+~#&/=]|[?.]\S)*)/gi;if(!e)return null;try{return(0,r.jsx)("span",{children:e.split(t).filter(e=>e).map((e,s)=>e.match(t)?(0,r.jsx)(z.L,{size:"S",theme:"secondary",href:e,target:"_blank",children:e},"".concat(e,"-").concat(s)):(0,r.jsx)(a.Fragment,{children:e},"".concat(e,"-").concat(s)))})}catch(t){return l.Tb("Failed to correctly parse query error message, ".concat(t)),e}}},89579:function(e,t,s){"use strict";s.d(t,{M:function(){return i},j:function(){return n}});var r=s(36458);let a=["GB","MB","KB"],l=(e,t)=>{switch(t){case"KB":return new r.O(e).shiftedBy(-3);case"MB":return new r.O(e).shiftedBy(-6);case"GB":return new r.O(e).shiftedBy(-9);default:return new r.O(e)}},n=e=>{let{sizeInBytes:t,unit:s}=e;if(void 0!==s)return{size:l(t,s),unit:s};for(let e of a)if(l(t,e).gte(1)||"KB"===e)return{size:l(t,e),unit:e};return{size:l(t,"KB"),unit:"KB"}},i=e=>{let{sizeInBytes:t,unit:s,maximumFractionDigits:r=2}=e,a=void 0===s?n({sizeInBytes:t}):{unit:s,size:l(t,s)};return"".concat(a.size.dp(r).toFormat()," ").concat(a.unit)}},52376:function(e){e.exports={withButton:"TableCell_withButton__zGVtN",expandLines:"TableCell_expandLines__v9z_n"}},28082:function(e){e.exports={table:"table_table__FDV2P","footer-defaults":"table_footer-defaults__fFoLi",footer:"table_footer__Ky_k2",hidden:"table_hidden__2BDwc",total:"table_total__eti_u",warning:"table_warning__7UQtK"}},69850:function(e){e.exports={wrap:"visual_wrap__0siae","theme-orange":"visual_theme-orange__5eW1v","theme-gray":"visual_theme-gray__T6HVs",text:"visual_text__m2M_L",counter:"visual_counter__OsyJZ",transparent:"visual_transparent___D_Vi",watermark:"visual_watermark__LDxGj",message:"visual_message__1fWJV",result:"visual_result__6q0xu",chart:"visual_chart__8di0g",table:"visual_table__LER0F","stretch-results":"visual_stretch-results__2Kjk1",datetime:"visual_datetime__cCdmH",left:"visual_left__Fr_dQ",right:"visual_right__zX_h_",center:"visual_center__McI4w",empty:"visual_empty__uR3Nb",coloredNegative:"visual_coloredNegative__FJR4J",coloredPositive:"visual_coloredPositive__2agAF",progressbar:"visual_progressbar__kWDKY",negative:"visual_negative__FHc5_",vizFooter:"visual_vizFooter__vCe59",ownerStatuses:"visual_ownerStatuses__tEKua",ownerAndResultAge:"visual_ownerAndResultAge__0un2N",buttonGroup:"visual_buttonGroup__YrGFd",statuses:"visual_statuses__06E9n",html:"visual_html__SB1cX",tableListValue:"visual_tableListValue__J6M37",contractButton:"visual_contractButton__aUU_1",expandButton:"visual_expandButton__T0zJF",resultMessage:"visual_resultMessage__JgmHi",runningStatus:"visual_runningStatus__EpEJN",progressBarWrapper:"visual_progressBarWrapper__T_Lgu"}}}]);
//# sourceMappingURL=184-13103e7b1e00c4ba.js.map